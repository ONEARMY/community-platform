import{j as e}from"./hoist-non-react-statics.cjs-CAIjOaGs.js";import{r as s}from"./index-BP8_t0zE.js";import{A}from"./ActionSet-CYj_dyFM.js";import{B as _}from"./Button-6xtNGWM4.js";import{d as S}from"./default_member-D4npYF8S.js";import{I as D,b as E,T as l,a as B,F as i}from"./theme-ui-components.esm-Dh60mSfC.js";import{L as N}from"./LinkifyText-CUSnR-IF.js";import{D as I}from"./DisplayDate-C0c9_euD.js";import{U as T}from"./Username-CXa16f_Y.js";const M=""+new URL("author-B-Cfy9t9.svg",import.meta.url).href,p=t=>{const{displayName:o,isCommentAuthor:n=!1,photoUrl:a}=t,i=o?`Avatar of ${o}`:"Avatar of comment author";return e.jsxs(e.Fragment,{children:[n&&e.jsx(D,{src:M,ml:1,mt:-10,sx:{marginLeft:["-10px","5px"],marginTop:["-35px","-35px"],width:["85px","85px"],zIndex:1,position:"absolute",pointerEvents:"none",maxWidth:"none"}}),e.jsx(E,{"data-cy":"commentAvatarImage",src:a??S,sx:{objectFit:"cover",width:["30px","50px"],height:["30px","50px"],...n&&{zIndex:2,position:"relative"}},alt:i,loading:"lazy"})]})};try{p.displayName="CommentAvatar",p.__docgenInfo={description:"",displayName:"CommentAvatar",props:{displayName:{defaultValue:null,description:"",name:"displayName",required:!1,type:{name:"string"}},isCommentAuthor:{defaultValue:null,description:"",name:"isCommentAuthor",required:!1,type:{name:"boolean"}},photoUrl:{defaultValue:null,description:"",name:"photoUrl",required:!1,type:{name:"string | null"}}}}}catch{}const V=129,x=({body:t})=>{const o=s.createRef(),[n,a]=s.useState(0),[i,r]=s.useState(!1);s.useEffect((()=>{o.current&&a(o.current.scrollHeight)}),[o]);const d=i?"max-content":"128px";return e.jsxs(e.Fragment,{children:[e.jsx(l,{"data-cy":"comment-text","data-testid":"commentText",sx:{fontFamily:"body",lineHeight:1.3,maxHeight:d,overflow:"hidden",whiteSpace:"pre-wrap",wordBreak:"break-word",fontSize:[2,3]},ref:o,children:e.jsx(N,{children:t})}),n>V&&e.jsx(l,{as:"a",onClick:()=>{r((e=>!e))},sx:{color:"gray",cursor:"pointer",fontSize:[2,3]},children:i?"Show less":"Show more"})]})};try{x.displayName="CommentBody",x.__docgenInfo={description:"",displayName:"CommentBody",props:{body:{defaultValue:null,description:"",name:"body",required:!0,type:{name:"string"}}}}}catch{}const q=s.createContext({authors:[]}),k="The original comment got deleted",v=t=>{var o,n,a,r,d,m,c;const{comment:u,isEditable:y,itemType:h,setShowDeleteModal:f,setShowEditModal:j,followButton:g,followButtonIcon:v}=t,{authors:b}=s.useContext(q),C=""+(u.highlighted?"2px dashed black":"none");return u.deleted?e.jsx(B,{sx:{marginBottom:2,border:C},"data-cy":"deletedComment",children:e.jsxs(l,{sx:{color:"grey"},children:["[",k,"]"]})}):u.deleted?void 0:e.jsxs(i,{sx:{gap:2,flexGrow:1,border:C},"data-cy":u.highlighted?"highlighted-comment":"",children:[e.jsx(B,{"data-cy":"commentAvatar","data-testid":"commentAvatar",sx:{flexDirection:"column",position:"relative",display:"inline-block"},children:e.jsx(p,{displayName:null==(o=u.createdBy)?void 0:o.displayName,photoUrl:null==(n=u.createdBy)?void 0:n.photoUrl,isCommentAuthor:!(null==(a=u.createdBy)||!a.id)&&b.includes(null==(r=u.createdBy)?void 0:r.id)})}),e.jsx(i,{sx:{flexDirection:"column",flex:1},children:e.jsxs(i,{sx:{justifyContent:"space-between",flexDirection:"column",gap:2},children:[e.jsxs(i,{sx:{gap:2,flexDirection:"row",justifyContent:"space-between"},children:[e.jsxs(i,{sx:{alignItems:"center",gap:2},children:[e.jsx(T,{user:{userName:(null==(d=u.createdBy)?void 0:d.username)||"",countryCode:null==(m=u.createdBy)?void 0:m.country,isVerified:null==(c=u.createdBy)?void 0:c.isVerified}}),e.jsx(l,{sx:{fontSize:1,color:"darkGrey"},children:e.jsx(I,{createdAt:u.createdAt,modifiedAt:u.modifiedAt,showLabel:!1})})]}),e.jsxs(i,{children:[v,e.jsxs(A,{itemType:h,children:[g,y&&e.jsx(_,{type:"button","data-cy":`${h}: edit button`,variant:"subtle",icon:"edit",onClick:()=>j(!0),sx:{fontSize:1},children:"Edit"}),y&&e.jsx(_,{type:"button","data-cy":`${h}: delete button`,variant:"subtle",icon:"delete",onClick:()=>f(!0),sx:{fontSize:1},children:"Delete"})]})]})]}),e.jsx(x,{body:u.comment})]})})]})};try{v.displayName="CommentDisplay",v.__docgenInfo={description:"",displayName:"CommentDisplay",props:{comment:{defaultValue:null,description:"",name:"comment",required:!0,type:{name:"Comment"}},isEditable:{defaultValue:null,description:"",name:"isEditable",required:!0,type:{name:"boolean | undefined"}},itemType:{defaultValue:null,description:"",name:"itemType",required:!0,type:{name:"enum",value:[{value:'"ReplyItem"'},{value:'"CommentItem"'}]}},setShowDeleteModal:{defaultValue:null,description:"",name:"setShowDeleteModal",required:!0,type:{name:"(arg: boolean) => void"}},setShowEditModal:{defaultValue:null,description:"",name:"setShowEditModal",required:!0,type:{name:"(arg: boolean) => void"}},followButton:{defaultValue:null,description:"",name:"followButton",required:!1,type:{name:"ReactNode"}},followButtonIcon:{defaultValue:null,description:"",name:"followButtonIcon",required:!1,type:{name:"ReactNode"}}}}}catch{}export{v as C};