import{r as a,j as e}from"./iframe-sdBLW9v8.js";import{B as x}from"./Button-C6dBjqwc.js";import{F as d,C as T,I,b as S,T as u,a as j}from"./theme-ui-components.esm-CqB0JU78.js";import{L as A}from"./LinkifyText-CBRq8TbV.js";import{D as B}from"./DisplayDate-Bkjv-fsn.js";import{U as D}from"./Username-CZgG_QL0.js";const b=({children:t,itemType:n})=>{const[o,i]=a.useState(!1),r=a.useRef(null),s=t.filter((e=>!!e));if(!t||0===s.length)return e.jsx(e.Fragment,{});return a.useEffect((()=>{const e=e=>{r.current&&!r.current.contains(e.target)&&i((e=>!e))};return o&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[o]),e.jsxs(d,{ref:r,sx:{display:"inline-block",position:"relative",gap:2},children:[e.jsx(x,{"data-cy":`${n}: ActionSetButton`,icon:"more-vert",onClick:()=>i((e=>!e)),variant:"subtle",showIconOnly:!0,children:"Show Actions"}),o&&e.jsx(T,{sx:{position:"absolute",right:0,zIndex:1,padding:1,gap:1,minWidth:"200px"},children:e.jsxs(d,{sx:{alignItems:"stretch",justifyItems:"stretch",flexDirection:"column"},children:[...t]})})]})};b.__docgenInfo={description:"",methods:[],displayName:"ActionSet",props:{children:{required:!0,tsType:{name:"Array",elements:[{name:"ReactNode"}],raw:"ReactNode[]"},description:""},itemType:{required:!0,tsType:{name:"union",raw:"'ReplyItem' | 'CommentItem'",elements:[{name:"literal",value:"'ReplyItem'"},{name:"literal",value:"'CommentItem'"}]},description:""}}};const E=""+new URL("author-B-Cfy9t9.svg",import.meta.url).href,R=""+new URL("default_member-BrNDumk0.svg",import.meta.url).href,C=t=>{const{displayName:n,isCommentAuthor:o=!1,photo:i}=t,r=n?`Avatar of ${n}`:"Avatar of comment author";return e.jsxs(e.Fragment,{children:[o&&e.jsx(I,{src:E,ml:1,mt:-10,sx:{marginLeft:["-10px","5px"],marginTop:["-35px","-35px"],width:["85px","85px"],zIndex:1,position:"absolute",pointerEvents:"none",maxWidth:"none"}}),e.jsx(S,{"data-cy":"commentAvatarImage",src:i??R,sx:{objectFit:"cover",width:["30px","50px"],height:["30px","50px"],...o&&{zIndex:2,position:"relative"}},alt:r,loading:"lazy"})]})};C.__docgenInfo={description:"",methods:[],displayName:"CommentAvatar",props:{displayName:{required:!1,tsType:{name:"string"},description:""},isCommentAuthor:{required:!1,tsType:{name:"boolean"},description:""},photo:{required:!1,tsType:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}]},description:""}}};const N=129,v=({body:t})=>{const n=a.createRef(),[o,i]=a.useState(0),[r,s]=a.useState(!1);a.useEffect((()=>{n.current&&i(n.current.scrollHeight)}),[n]);const d=r?"max-content":"128px";return e.jsxs(e.Fragment,{children:[e.jsx(u,{"data-cy":"comment-text","data-testid":"commentText",sx:{fontFamily:"body",lineHeight:1.3,maxHeight:d,overflow:"hidden",whiteSpace:"pre-wrap",wordBreak:"break-word",fontSize:[2,3]},ref:n,children:e.jsx(A,{children:t})}),o>N&&e.jsx(u,{as:"a",onClick:()=>{s((e=>!e))},sx:{color:"gray",cursor:"pointer",fontSize:[2,3]},children:r?"Show less":"Show more"})]})};v.__docgenInfo={description:"",methods:[],displayName:"CommentBody",props:{body:{required:!0,tsType:{name:"string"},description:""}}};const k=a.createContext({authors:[]}),q="The original comment got deleted",M=t=>{var n,o,i,r,s;const{comment:m,isEditable:l,itemType:c,setShowDeleteModal:p,setShowEditModal:h,followButton:y,followButtonIcon:f}=t,{authors:g}=a.useContext(k),w=""+(m.highlighted?"2px dashed black":"none");return m.deleted?e.jsx(j,{sx:{marginBottom:2,border:w},"data-cy":"deletedComment",children:e.jsxs(u,{sx:{color:"grey"},children:["[",q,"]"]})}):m.deleted?void 0:e.jsxs(d,{sx:{gap:2,flexGrow:1,border:w},"data-cy":m.highlighted?"highlighted-comment":"",children:[e.jsx(j,{"data-cy":"commentAvatar","data-testid":"commentAvatar",sx:{flexDirection:"column",position:"relative",display:"inline-block"},children:e.jsx(C,{displayName:null==(n=m.createdBy)?void 0:n.displayName,photo:null==(i=null==(o=m.createdBy)?void 0:o.photo)?void 0:i.publicUrl,isCommentAuthor:!(null==(r=m.createdBy)||!r.id)&&g.includes(null==(s=m.createdBy)?void 0:s.id)})}),e.jsx(d,{sx:{flexDirection:"column",flex:1},children:e.jsxs(d,{sx:{justifyContent:"space-between",flexDirection:"column",gap:2},children:[e.jsxs(d,{sx:{gap:2,flexDirection:"row",justifyContent:"space-between"},children:[e.jsxs(d,{sx:{alignItems:"center",gap:2},children:[m.createdBy&&e.jsx(D,{user:m.createdBy}),e.jsx(u,{sx:{fontSize:1,color:"darkGrey"},children:e.jsx(B,{createdAt:m.createdAt,modifiedAt:m.modifiedAt,showLabel:!1})})]}),e.jsxs(d,{children:[f,e.jsxs(b,{itemType:c,children:[y,l&&e.jsx(x,{type:"button","data-cy":`${c}: edit button`,variant:"subtle",icon:"edit",onClick:()=>h(!0),sx:{fontSize:1},children:"Edit"}),l&&e.jsx(x,{type:"button","data-cy":`${c}: delete button`,variant:"subtle",icon:"delete",onClick:()=>p(!0),sx:{fontSize:1},children:"Delete"})]})]})]}),e.jsx(v,{body:m.comment})]})})]})};M.__docgenInfo={description:"",methods:[],displayName:"CommentDisplay",props:{comment:{required:!0,tsType:{name:"Comment"},description:""},isEditable:{required:!0,tsType:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}]},description:""},itemType:{required:!0,tsType:{name:"union",raw:"'ReplyItem' | 'CommentItem'",elements:[{name:"literal",value:"'ReplyItem'"},{name:"literal",value:"'CommentItem'"}]},description:""},setShowDeleteModal:{required:!0,tsType:{name:"signature",type:"function",raw:"(arg: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"arg"}],return:{name:"void"}}},description:""},setShowEditModal:{required:!0,tsType:{name:"signature",type:"function",raw:"(arg: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"arg"}],return:{name:"void"}}},description:""},followButton:{required:!1,tsType:{name:"ReactNode"},description:""},followButtonIcon:{required:!1,tsType:{name:"ReactNode"},description:""}}};export{M as C};