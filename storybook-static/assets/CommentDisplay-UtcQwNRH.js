import{j as t}from"./jsx-runtime-CexXSJP5.js";import{r as s}from"./index-BP8_t0zE.js";import{B as j}from"./Button-BUCkskO-.js";import{d as w}from"./default_member-D4npYF8S.js";import{I as A,b as B,T as m,a as C,F as i}from"./theme-ui-components.esm-Cq1N8tMa.js";import{L as D}from"./LinkifyText-DxSi-NTn.js";import{r as S,t as v,D as E}from"./DisplayDate-0CQG0G5T.js";import{U as T}from"./Username-Czb60CDd.js";function I(e,t){S(2,arguments);var o=v(e),a=v(t),n=o.getTime()-a.getTime();return n>0?-1:n<0?1:n}const M=""+new URL("author-B-Cfy9t9.svg",import.meta.url).href,u=({name:e,photoUrl:o,isCommentAuthor:a=!1})=>t.jsxs(t.Fragment,{children:[a&&t.jsx(A,{src:M,ml:1,mt:-10,sx:{marginLeft:["-10px","5px"],marginTop:["-35px","-35px"],width:["85px","85px"],zIndex:1,position:"absolute",pointerEvents:"none",maxWidth:"none"}}),t.jsx(B,{"data-cy":"commentAvatarImage",src:o??w,sx:{objectFit:"cover",width:["30px","50px"],height:["30px","50px"],...a&&{zIndex:2,position:"relative"}},alt:e?`Avatar of ${e}`:"Avatar of comment author",loading:"lazy"})]});try{u.displayName="CommentAvatar",u.__docgenInfo={description:"",displayName:"CommentAvatar",props:{name:{defaultValue:null,description:"",name:"name",required:!1,type:{name:"string"}},photoUrl:{defaultValue:null,description:"",name:"photoUrl",required:!1,type:{name:"string"}},isCommentAuthor:{defaultValue:{value:"false"},description:"",name:"isCommentAuthor",required:!1,type:{name:"boolean"}}}}}catch{}const V=129,x=({body:e})=>{const o=s.createRef(),[a,n]=s.useState(0),[i,r]=s.useState(!1);s.useEffect((()=>{o.current&&n(o.current.scrollHeight)}),[o]);const d=i?"max-content":"128px";return t.jsxs(t.Fragment,{children:[t.jsx(m,{"data-cy":"comment-text","data-testid":"commentText",sx:{fontFamily:"body",lineHeight:1.3,maxHeight:d,overflow:"hidden",whiteSpace:"pre-wrap",wordBreak:"break-word",fontSize:[2,3]},ref:o,children:t.jsx(D,{children:e})}),a>V&&t.jsx(m,{as:"a",onClick:()=>{r((e=>!e))},sx:{color:"gray",cursor:"pointer",fontSize:[2,3]},children:i?"Show less":"Show more"})]})};try{x.displayName="CommentBody",x.__docgenInfo={description:"",displayName:"CommentBody",props:{body:{defaultValue:null,description:"",name:"body",required:!0,type:{name:"string"}}}}}catch{}const k=s.createContext({authors:[]}),q="The original comment got deleted",_=e=>{var o,a,n,r,d,l,c;const{comment:p,isEditable:h,itemType:y,setShowDeleteModal:f,setShowEditModal:g}=e,{authors:v}=s.useContext(k);return p.deleted?t.jsx(C,{sx:{marginBottom:2,border:""+(p.highlighted?"2px dashed black":"none")},"data-cy":"deletedComment",children:t.jsxs(m,{sx:{color:"grey"},children:["[",q,"]"]})}):p.deleted?void 0:t.jsxs(i,{sx:{gap:2,flexGrow:1,border:""+(p.highlighted?"2px dashed black":"none")},children:[t.jsx(C,{"data-cy":"commentAvatar","data-testid":"commentAvatar",sx:{flexDirection:"column",position:"relative",display:"inline-block"},children:t.jsx(u,{name:null==(o=p.createdBy)?void 0:o.name,photoUrl:null==(a=p.createdBy)?void 0:a.photoUrl,isCommentAuthor:!(null==(n=p.createdBy)||!n.id)&&v.includes(null==(r=p.createdBy)?void 0:r.id)})}),t.jsx(i,{sx:{flexDirection:"column",flex:1},children:t.jsxs(i,{sx:{justifyContent:"space-between",flexDirection:"column",gap:2},children:[t.jsxs(i,{sx:{gap:2,flexDirection:"row",justifyContent:"space-between",flexWrap:"wrap"},children:[t.jsxs(i,{sx:{alignItems:"center",gap:2},children:[t.jsx(T,{user:{userName:(null==(d=p.createdBy)?void 0:d.username)||"",countryCode:null==(l=p.createdBy)?void 0:l.country,isVerified:null==(c=p.createdBy)?void 0:c.isVerified}}),t.jsxs(m,{sx:{fontSize:1,color:"darkGrey"},children:[p.modifiedAt&&I(p.createdAt,p.modifiedAt)>0&&"Edited ",t.jsx(E,{date:p.modifiedAt||p.createdAt})]})]}),h&&t.jsxs(i,{sx:{alignItems:"flex-end",gap:2},children:[t.jsx(j,{type:"button","data-cy":`${y}: edit button`,variant:"subtle",small:!0,icon:"edit",onClick:()=>g(!0),children:"edit"}),t.jsx(j,{type:"button","data-cy":`${y}: delete button`,variant:"subtle",small:!0,icon:"delete",onClick:()=>f(!0),children:"delete"})]})]}),t.jsx(x,{body:p.comment})]})})]})};try{_.displayName="CommentDisplay",_.__docgenInfo={description:"",displayName:"CommentDisplay",props:{comment:{defaultValue:null,description:"",name:"comment",required:!0,type:{name:"Comment"}},isEditable:{defaultValue:null,description:"",name:"isEditable",required:!0,type:{name:"boolean | undefined"}},itemType:{defaultValue:null,description:"",name:"itemType",required:!0,type:{name:"enum",value:[{value:'"ReplyItem"'},{value:'"CommentItem"'}]}},setShowDeleteModal:{defaultValue:null,description:"",name:"setShowDeleteModal",required:!0,type:{name:"(arg: boolean) => void"}},setShowEditModal:{defaultValue:null,description:"",name:"setShowEditModal",required:!0,type:{name:"(arg: boolean) => void"}}}}}catch{}export{_ as C};