import{r as n,j as e}from"./iframe-Cnv6e--Z.js";import{d as O}from"./default_member-D4npYF8S.js";import{A as $}from"./ActionSet-T1ifOQSq.js";import{B as y}from"./Button-CCqkXNst.js";import{C as N}from"./ConfirmModal-CRY_5s3W.js";import{D as F}from"./DisplayDate-BIUv8ujb.js";import{E as L}from"./EditComment-L_GS1DnB.js";import{L as U}from"./LinkifyText-lZWFT5Yc.js";import{M as G}from"./Modal-DtxhKkXZ.js";import{U as V}from"./Username-D04Cxiqt.js";import{F as t,a as w,T as l,b as z}from"./theme-ui-components.esm-DCqhxKwX.js";const W=129,J="The original comment got deleted",K=r=>{const i=n.createRef(),[s,a]=n.useState(!1),[o,m]=n.useState(!1),[d,c]=n.useState(0),[p,x]=n.useState(!1),{comment:u,handleDelete:h,handleEditRequest:f,handleEdit:g,isReply:j}=r,{text:C,creatorName:v,creatorCountry:b,creatorImage:I,isUserVerified:T,isUserSupporter:D,isEditable:S,_created:q,_edited:A,_id:k,_deleted:B}=u,_={userName:v,countryCode:b,isVerified:!!T,isSupporter:!!D},E=p?"max-content":"128px",R=j?"ReplyItem":"CommentItem";n.useEffect((()=>{i.current&&c(i.current.scrollHeight)}),[i]);return e.jsxs(t,{id:`comment:${k}`,"data-cy":S?`Own${R}`:R,sx:{flexDirection:"column"},children:[e.jsxs(t,{sx:{gap:2},children:[B&&e.jsx(w,{sx:{marginBottom:2},"data-cy":"deletedComment",children:e.jsxs(l,{sx:{color:"grey"},children:["[",J,"]"]})}),!B&&e.jsxs(t,{sx:{gap:2,flexGrow:1},children:[e.jsx(w,{"data-cy":"commentAvatar","data-testid":"commentAvatar",children:e.jsx(z,{"data-cy":"commentAvatarImage",src:I??O,sx:{objectFit:"cover",width:["30px","50px"],height:["30px","50px"]},alt:v?`Avatar of ${v}`:"Avatar of comment author"})}),e.jsxs(t,{sx:{flexDirection:"column",flex:1},children:[e.jsxs(t,{sx:{flexWrap:"wrap",justifyContent:"space-between",flexDirection:["column","row"],gap:2},children:[e.jsxs(t,{sx:{alignItems:"baseline",gap:2,flexDirection:"row"},children:[e.jsx(V,{user:_}),e.jsx(l,{sx:{fontSize:1,color:"darkGrey"},children:e.jsx(F,{createdAt:q||"",modifiedAt:A,showLabel:!1})})]}),S&&e.jsx(t,{sx:{alignItems:"flex-end",gap:2,paddingBottom:2},children:e.jsxs($,{itemType:R,children:[e.jsx(y,{type:"button","data-cy":`${R}: edit button`,variant:"subtle",small:!0,icon:"edit",onClick:()=>(e=>{if(f)return f(e),a(!0)})(k),children:"edit"}),e.jsx(y,{type:"button","data-cy":`${R}: delete button`,variant:"subtle",small:!0,icon:"delete",onClick:()=>m(!0),children:"delete"})]})})]}),e.jsx(l,{"data-cy":"comment-text","data-testid":"commentText",sx:{fontFamily:"body",lineHeight:1.3,maxHeight:E,overflow:"hidden",whiteSpace:"pre-wrap",wordBreak:"break-word",marginTop:1,marginBottom:2},ref:i,children:e.jsx(U,{children:C})}),d>W&&e.jsx("a",{onClick:()=>{x(!p)},style:{color:"gray",cursor:"pointer"},children:p?"Show less":"Show more"})]})]})]}),e.jsx(G,{width:600,isOpen:s,children:e.jsx(L,{comment:C,handleSubmit:async e=>{await g(k,e),a(!1)},handleCancel:()=>a(!1),isReply:j})}),e.jsx(N,{isOpen:o,message:"Are you sure you want to delete this comment?",confirmButtonText:"Delete",handleCancel:()=>m(!1),handleConfirm:async()=>{h&&await h(k),m(!1)}})]})};K.__docgenInfo={description:"",methods:[],displayName:"CommentItem",props:{comment:{required:!0,tsType:{name:"IComment"},description:""},handleDelete:{required:!1,tsType:{name:"signature",type:"function",raw:"(commentId: string) => Promise<void>",signature:{arguments:[{type:{name:"string"},name:"commentId"}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},handleEdit:{required:!0,tsType:{name:"signature",type:"function",raw:"(commentId: string, newCommentText: string) => void",signature:{arguments:[{type:{name:"string"},name:"commentId"},{type:{name:"string"},name:"newCommentText"}],return:{name:"void"}}},description:""},handleEditRequest:{required:!1,tsType:{name:"signature",type:"function",raw:"(commentId: string) => Promise<void>",signature:{arguments:[{type:{name:"string"},name:"commentId"}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},isReply:{required:!0,tsType:{name:"boolean"},description:""}}};export{K as C};