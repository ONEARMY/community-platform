import{j as e}from"./jsx-runtime-CexXSJP5.js";import{r as o}from"./index-BP8_t0zE.js";import{d as O}from"./default_member-D4npYF8S.js";import{A as $}from"./ActionSet-BLrZUNDv.js";import{B as j}from"./Button-s-S1fAuq.js";import{C as F}from"./ConfirmModal-BbHPfjT5.js";import{D as L}from"./DisplayDate-Qat9vqcB.js";import{E as U}from"./EditComment-DRquUOI9.js";import{L as P}from"./LinkifyText-DcaiGz_R.js";import{M as G}from"./Modal-CqEalRwc.js";import{U as z}from"./Username-CerBWMtQ.js";import{F as t,a as w,T as c,b as W}from"./theme-ui-components.esm-D81fpbIc.js";const J=129,K="The original comment got deleted",C=a=>{const r=o.createRef(),[n,i]=o.useState(!1),[s,m]=o.useState(!1),[d,l]=o.useState(0),[p,u]=o.useState(!1),{comment:x,handleDelete:f,handleEditRequest:h,handleEdit:y,isReply:g}=a,{text:C,creatorName:b,creatorCountry:D,creatorImage:I,isUserVerified:S,isUserSupporter:v,isEditable:q,_created:B,_edited:E,_id:R,_deleted:A}=x,T={userName:b,countryCode:D,isVerified:!!S,isSupporter:!!v},_=p?"max-content":"128px",k=g?"ReplyItem":"CommentItem";o.useEffect((()=>{r.current&&l(r.current.scrollHeight)}),[r]);return e.jsxs(t,{id:`comment:${R}`,"data-cy":q?`Own${k}`:k,sx:{flexDirection:"column"},children:[e.jsxs(t,{sx:{gap:2},children:[A&&e.jsx(w,{sx:{marginBottom:2},"data-cy":"deletedComment",children:e.jsxs(c,{sx:{color:"grey"},children:["[",K,"]"]})}),!A&&e.jsxs(t,{sx:{gap:2,flexGrow:1},children:[e.jsx(w,{"data-cy":"commentAvatar","data-testid":"commentAvatar",children:e.jsx(W,{"data-cy":"commentAvatarImage",src:I??O,sx:{objectFit:"cover",width:["30px","50px"],height:["30px","50px"]},alt:b?`Avatar of ${b}`:"Avatar of comment author"})}),e.jsxs(t,{sx:{flexDirection:"column",flex:1},children:[e.jsxs(t,{sx:{flexWrap:"wrap",justifyContent:"space-between",flexDirection:["column","row"],gap:2},children:[e.jsxs(t,{sx:{alignItems:"baseline",gap:2,flexDirection:"row"},children:[e.jsx(z,{user:T}),e.jsx(c,{sx:{fontSize:1,color:"darkGrey"},children:e.jsx(L,{createdAt:B||"",modifiedAt:E,showLabel:!1})})]}),q&&e.jsx(t,{sx:{alignItems:"flex-end",gap:2,paddingBottom:2},children:e.jsxs($,{itemType:k,children:[e.jsx(j,{type:"button","data-cy":`${k}: edit button`,variant:"subtle",small:!0,icon:"edit",onClick:()=>(e=>{if(h)return h(e),i(!0)})(R),children:"edit"}),e.jsx(j,{type:"button","data-cy":`${k}: delete button`,variant:"subtle",small:!0,icon:"delete",onClick:()=>m(!0),children:"delete"})]})})]}),e.jsx(c,{"data-cy":"comment-text","data-testid":"commentText",sx:{fontFamily:"body",lineHeight:1.3,maxHeight:_,overflow:"hidden",whiteSpace:"pre-wrap",wordBreak:"break-word",marginTop:1,marginBottom:2},ref:r,children:e.jsx(P,{children:C})}),d>J&&e.jsx("a",{onClick:()=>{u(!p)},style:{color:"gray",cursor:"pointer"},children:p?"Show less":"Show more"})]})]})]}),e.jsx(G,{width:600,isOpen:n,children:e.jsx(U,{comment:C,handleSubmit:async e=>{await y(R,e),i(!1)},handleCancel:()=>i(!1),isReply:g})}),e.jsx(F,{isOpen:s,message:"Are you sure you want to delete this comment?",confirmButtonText:"Delete",handleCancel:()=>m(!1),handleConfirm:async()=>{f&&await f(R),m(!1)}})]})};try{C.displayName="CommentItem",C.__docgenInfo={description:"",displayName:"CommentItem",props:{comment:{defaultValue:null,description:"",name:"comment",required:!0,type:{name:"IComment"}},handleDelete:{defaultValue:null,description:"",name:"handleDelete",required:!1,type:{name:"((commentId: string) => Promise<void>)"}},handleEdit:{defaultValue:null,description:"",name:"handleEdit",required:!0,type:{name:"(commentId: string, newCommentText: string) => void"}},handleEditRequest:{defaultValue:null,description:"",name:"handleEditRequest",required:!1,type:{name:"((commentId: string) => Promise<void>)"}},isReply:{defaultValue:null,description:"",name:"isReply",required:!0,type:{name:"boolean"}}}}}catch{}export{C};