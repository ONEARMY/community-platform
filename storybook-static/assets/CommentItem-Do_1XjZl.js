import{j as e}from"./jsx-runtime-CexXSJP5.js";import{r as o}from"./index-BP8_t0zE.js";import{B as j}from"./Button-CNNOBp5d.js";import{C as O}from"./ConfirmModal-nn9TD5JG.js";import{D as $}from"./DisplayDate-6lOgCKow.js";import{E as U}from"./EditComment-DoS6A2RY.js";import{L as F}from"./LinkifyText-DWykfnAH.js";import{M as L}from"./Modal-DXxaFBTe.js";import{U as P}from"./Username-Cu73ouL4.js";import{F as t,a as C,T as c,g as G}from"./theme-ui-components.esm-BngKL4Rx.js";const z=""+new URL("default_member-BrNDumk0.svg",import.meta.url).href,W=129,J="The original comment got deleted",E=n=>{const a=o.createRef(),[r,i]=o.useState(!1),[s,m]=o.useState(!1),[d,l]=o.useState(0),[u,p]=o.useState(!1),{comment:x,handleDelete:h,handleEditRequest:f,handleEdit:y,isReply:g}=n,{text:w,creatorName:D,creatorCountry:E,creatorImage:b,isUserVerified:v,isUserSupporter:I,isEditable:S,_created:B,_edited:R,_id:k,_deleted:T}=x,q={userName:D,countryCode:E,isVerified:!!v,isSupporter:!!I},A=u?"max-content":"128px",_=g?"ReplyItem":"CommentItem";o.useEffect((()=>{a.current&&l(a.current.scrollHeight)}),[a]);return e.jsxs(t,{id:`comment:${k}`,"data-cy":S?`Own${_}`:_,sx:{flexDirection:"column"},children:[e.jsxs(t,{sx:{gap:2},children:[T&&e.jsx(C,{sx:{marginBottom:2},"data-cy":"deletedComment",children:e.jsxs(c,{sx:{color:"grey"},children:["[",J,"]"]})}),!T&&e.jsxs(t,{sx:{gap:2,flexGrow:1},children:[e.jsx(C,{"data-cy":"commentAvatar","data-testid":"commentAvatar",children:e.jsx(G,{"data-cy":"commentAvatarImage",src:b??z,sx:{objectFit:"cover",width:["30px","50px"],height:["30px","50px"]},alt:D?`Avatar of ${D}`:"Avatar of comment author"})}),e.jsxs(t,{sx:{flexDirection:"column",flex:1},children:[e.jsxs(t,{sx:{flexWrap:"wrap",justifyContent:"space-between",flexDirection:["column","row"],gap:2},children:[e.jsxs(t,{sx:{alignItems:"baseline",gap:2,flexDirection:"row"},children:[e.jsx(P,{user:q}),e.jsxs(c,{sx:{fontSize:1,color:"darkGrey"},children:[R&&"Edited ",e.jsx($,{date:R||B})]})]}),S&&e.jsxs(t,{sx:{alignItems:"flex-end",gap:2,paddingBottom:2},children:[e.jsx(j,{type:"button","data-cy":`${_}: edit button`,variant:"subtle",small:!0,icon:"edit",onClick:()=>(e=>{if(f)return f(e),i(!0)})(k),children:"edit"}),e.jsx(j,{type:"button","data-cy":`${_}: delete button`,variant:"subtle",small:!0,icon:"delete",onClick:()=>m(!0),children:"delete"})]})]}),e.jsx(c,{"data-cy":"comment-text","data-testid":"commentText",sx:{fontFamily:"body",lineHeight:1.3,maxHeight:A,overflow:"hidden",whiteSpace:"pre-wrap",wordBreak:"break-word",marginTop:1,marginBottom:2},ref:a,children:e.jsx(F,{children:w})}),d>W&&e.jsx("a",{onClick:()=>{p(!u)},style:{color:"gray",cursor:"pointer"},children:u?"Show less":"Show more"})]})]})]}),e.jsx(L,{width:600,isOpen:r,children:e.jsx(U,{comment:w,handleSubmit:async e=>{await y(k,e),i(!1)},handleCancel:()=>i(!1),isReply:g})}),e.jsx(O,{isOpen:s,message:"Are you sure you want to delete this comment?",confirmButtonText:"Delete",handleCancel:()=>m(!1),handleConfirm:async()=>{h&&await h(k),m(!1)}})]})};try{E.displayName="CommentItem",E.__docgenInfo={description:"",displayName:"CommentItem",props:{comment:{defaultValue:null,description:"",name:"comment",required:!0,type:{name:"IComment"}},handleDelete:{defaultValue:null,description:"",name:"handleDelete",required:!1,type:{name:"((commentId: string) => Promise<void>)"}},handleEdit:{defaultValue:null,description:"",name:"handleEdit",required:!0,type:{name:"(commentId: string, newCommentText: string) => void"}},handleEditRequest:{defaultValue:null,description:"",name:"handleEditRequest",required:!1,type:{name:"((commentId: string) => Promise<void>)"}},isReply:{defaultValue:null,description:"",name:"isReply",required:!0,type:{name:"boolean"}}}}}catch{}export{E as C,z as d};