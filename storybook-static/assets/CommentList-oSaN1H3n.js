import{r as R,j as e}from"./iframe-hKNIfn5j.js";import{B as P}from"./Button-C5INu9B6.js";import{B as b}from"./ButtonShowReplies-BXCPS8Fs.js";import{C as _}from"./CommentItem-DGC0lzLW.js";import{C as j}from"./CreateReply-Cj59V480.js";import{n as E}from"./DiscussionTitle-DI83cPvX.js";import{I as S}from"./Icon-D3mnePQc.js";import{F as f,a as C}from"./theme-ui-components.esm-DKTvS5i7.js";const I=10,q=n=>{const[t,i]=R.useState(!1),{comment:r,handleDelete:s,handleEditRequest:m,handleEdit:o,supportReplies:a,isLoggedIn:d,isReplies:p,maxLength:u,onSubmitReply:l}=n,{_id:g,_deleted:c,replies:y}=r,h=()=>e.jsx(b,{isShowReplies:t,replies:y||[],setIsShowReplies:()=>i(!t)});return!c||y&&0!==E(y)?e.jsxs(C,{sx:{backgroundColor:"white",borderRadius:1,padding:p?0:2},children:[e.jsx(_,{comment:r,handleEditRequest:m,handleDelete:s,handleEdit:o,isReply:!!p}),a&&!t&&h(),a&&t?e.jsxs(f,{sx:{alignItems:"stretch",flexDirection:"row"},children:[y&&e.jsx(C,{sx:{paddingTop:1,paddingRight:2},children:e.jsx(S,{glyph:"arrow-curved-bottom-right"})}),e.jsxs(f,{sx:{alignItems:"stretch",flexDirection:"column",flex:1},children:[e.jsx(T,{comments:y||[],handleDelete:s,handleEdit:o,handleEditRequest:m,isLoggedIn:d,isReplies:!0,maxLength:u,supportReplies:!1}),!c&&(()=>{if(l)return e.jsx(j,{commentId:g,isLoggedIn:d,maxLength:u,onSubmit:l})})(),h()]})]}):null]}):null},T=n=>{const{comments:t,handleDelete:i,handleEdit:r,handleEditRequest:s,highlightedCommentId:m,isLoggedIn:o,isReplies:a,maxLength:d,onMoreComments:p,onSubmitReply:u,supportReplies:l=!1}=n,[g,c]=R.useState(1),y=g*I;return R.useEffect((()=>{if(!m)return;const e=t.findIndex((e=>m.includes(e._id)));e>=0&&(c(Math.floor(e/I)+1),(e=>{setTimeout((()=>{var n;null==(n=document.getElementById(`comment:${e}`))||n.scrollIntoView({behavior:"smooth",block:"start"})}),0)})(m))}),[m,t]),e.jsxs(f,{sx:{gap:2,flexDirection:"column"},children:[t&&t.slice(0,y).map((n=>e.jsx(C,{"data-testid":"CommentList: item",sx:{border:""+(m===n._id?"2px dashed black":"none"),borderRadius:1},children:e.jsx(q,{comment:n,handleEditRequest:s,handleDelete:i,handleEdit:r,isLoggedIn:o,isReplies:a,maxLength:d,onSubmitReply:u,supportReplies:l})},n._id))),t&&t.length>y&&e.jsx(f,{children:e.jsx(P,{type:"button",sx:{margin:"0 auto"},variant:"outline","data-cy":"show-more-comments",onClick:()=>{p&&p(),c(g+1)},children:"show more comments"})})]})};q.__docgenInfo={description:"",methods:[],displayName:"CommentContainer",props:{handleDelete:{required:!0,tsType:{name:"signature",type:"function",raw:"(_id: string) => Promise<void>",signature:{arguments:[{type:{name:"string"},name:"_id"}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},handleEdit:{required:!0,tsType:{name:"signature",type:"function",raw:"(_id: string, comment: string) => Promise<void>",signature:{arguments:[{type:{name:"string"},name:"_id"},{type:{name:"string"},name:"comment"}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},handleEditRequest:{required:!0,tsType:{name:"signature",type:"function",raw:"() => Promise<void>",signature:{arguments:[],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},isLoggedIn:{required:!0,tsType:{name:"boolean"},description:""},isReplies:{required:!0,tsType:{name:"boolean"},description:""},maxLength:{required:!0,tsType:{name:"number"},description:""},onSubmitReply:{required:!1,tsType:{name:"signature",type:"function",raw:"(_id: string, reply: string) => Promise<void>",signature:{arguments:[{type:{name:"string"},name:"_id"},{type:{name:"string"},name:"reply"}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},comment:{required:!0,tsType:{name:"IComment"},description:""},handleCommentReply:{required:!1,tsType:{name:"signature",type:"function",raw:"(commentId: string | null) => void",signature:{arguments:[{type:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}]},name:"commentId"}],return:{name:"void"}}},description:""},supportReplies:{required:!0,tsType:{name:"boolean"},description:""}}},T.__docgenInfo={description:"",methods:[],displayName:"CommentList",props:{handleDelete:{required:!0,tsType:{name:"signature",type:"function",raw:"(_id: string) => Promise<void>",signature:{arguments:[{type:{name:"string"},name:"_id"}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},handleEdit:{required:!0,tsType:{name:"signature",type:"function",raw:"(_id: string, comment: string) => Promise<void>",signature:{arguments:[{type:{name:"string"},name:"_id"},{type:{name:"string"},name:"comment"}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},handleEditRequest:{required:!0,tsType:{name:"signature",type:"function",raw:"() => Promise<void>",signature:{arguments:[],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},isLoggedIn:{required:!0,tsType:{name:"boolean"},description:""},isReplies:{required:!0,tsType:{name:"boolean"},description:""},maxLength:{required:!0,tsType:{name:"number"},description:""},onSubmitReply:{required:!1,tsType:{name:"signature",type:"function",raw:"(_id: string, reply: string) => Promise<void>",signature:{arguments:[{type:{name:"string"},name:"_id"},{type:{name:"string"},name:"reply"}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},supportReplies:{required:!1,tsType:{name:"boolean"},description:""},comments:{required:!0,tsType:{name:"Array",elements:[{name:"IComment"}],raw:"IComment[]"},description:""},highlightedCommentId:{required:!1,tsType:{name:"string"},description:""},onMoreComments:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},setCommentBeingRepliedTo:{required:!1,tsType:{name:"signature",type:"function",raw:"(commentId: string | null) => void",signature:{arguments:[{type:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}]},name:"commentId"}],return:{name:"void"}}},description:""}}};export{T as C};