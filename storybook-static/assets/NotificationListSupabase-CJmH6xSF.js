import{j as e}from"./jsx-runtime-CexXSJP5.js";import{r as k}from"./index-BP8_t0zE.js";import{B as m}from"./Button-BYsjdR8l.js";import{B as j}from"./ButtonIcon-BCh0LYqW.js";import{I as x}from"./InternalLink-DHSMbK1G.js";import{L as C}from"./Loader-twX8xvbf.js";import{D as N}from"./DisplayDate-DgF3z8a8.js";import{I as h}from"./Icon-vnsTwUGF.js";import{F as n,T as g,H as v,a as w}from"./theme-ui-components.esm-Cq1N8tMa.js";const b=i=>{var t,o,a,s,r;const{markRead:d,modalDismiss:l,notification:c}=i,u=`/${c.sourceContentType}/${c.sourceContent.slug}`,m="news"!==c.contentType?"discussion":"thunderbolt",p={background:c.isRead?"background":"#fff0b4",borderColor:c.isRead?"background":"activeYellow",borderRadius:3,borderStyle:"solid",borderWidth:2,padding:2,gap:2};return e.jsxs(n,{"data-cy":"NotificationListItemSupabase","data-testid":"NotificationListItemSupabase",sx:{gap:2},children:[e.jsx(n,{sx:{...p,alignItems:"center",cursor:"pointer",display:c.isRead?"none":"flex","&:hover":{background:"#fee77b"}},onClick:()=>d(c.id),children:e.jsx(h,{"data-cy":"NotificationListItemSupabase-unread",glyph:"chevron-right"})}),e.jsxs(n,{sx:{...p,flex:1},children:["news"!==c.contentType&&e.jsx(n,{children:e.jsx(h,{glyph:m,size:30})}),e.jsxs(n,{sx:{flex:1,flexDirection:"column",gap:2},children:[e.jsxs(n,{sx:{justifyContent:"space-between",gap:2},children:[e.jsxs(g,{children:[e.jsx(x,{to:`/u/${null==(t=c.triggeredBy)?void 0:t.username}`,sx:{color:"grey","&:hover":{textDecoration:"underline"}},onClick:l,children:null==(o=c.triggeredBy)?void 0:o.username})," ","has left a new ",c.contentType,c.sourceContent.title&&e.jsxs(e.Fragment,{children:[" on "," ",e.jsx(x,{to:u,sx:{color:"black",fontWeight:"bold","&:hover":{textDecoration:"underline"}},onClick:l,children:c.sourceContent.title})]})]}),e.jsx(g,{sx:{fontSize:1,color:"grey",textAlign:"right"},children:e.jsx(N,{createdAt:c.createdAt,modifiedAt:c.modifiedAt,showLabel:!1})})]}),e.jsx(x,{to:`${u}#comment:${null==(a=c.content)?void 0:a.id}`,sx:{color:"black"},onClick:l,children:e.jsx(n,{sx:{background:"#E2EDF7",border:"2px solid black",borderRadius:5,padding:2},children:(null==(s=c.content)?void 0:s.comment)&&e.jsx(g,{sx:{alignSelf:"flex-start"},children:null==(r=c.content)?void 0:r.comment})})})]})]})]})};try{b.displayName="NotificationListItemSupabase",b.__docgenInfo={description:"",displayName:"NotificationListItemSupabase",props:{markRead:{defaultValue:null,description:"",name:"markRead",required:!0,type:{name:"(id: number) => void"}},modalDismiss:{defaultValue:null,description:"",name:"modalDismiss",required:!0,type:{name:"() => void"}},notification:{defaultValue:null,description:"",name:"notification",required:!0,type:{name:"Notification"}}}}}catch{}const y=i=>{const[t,o]=k.useState(!0),{isUpdatingNotifications:a,markAllRead:s,markRead:r,modalDismiss:d,notifications:l}=i,c=l.filter((({isRead:e})=>!e)).length>0,u=l.filter((({isRead:e})=>t?!e:!e||e)).sort(((e,i)=>e.createdAt<i.createdAt?1:0));return e.jsxs(n,{"data-cy":"NotificationListSupabase",sx:{flexDirection:"column",gap:4},children:[e.jsxs(n,{sx:{alignItems:"center",justifyContent:"space-between"},children:[e.jsx(v,{sx:{fontSize:6},children:"Notifications"}),e.jsx(j,{"data-cy":"MapFilterList-CloseButton",icon:"close",onClick:d,sx:{border:"none",paddingLeft:2,paddingRight:3}})]}),e.jsxs(n,{sx:{justifyContent:"space-between",alignItems:"center",flexDirection:"row",gap:2},children:[e.jsxs(n,{sx:{alignItems:"center",gap:2},children:[e.jsxs(n,{sx:{border:"2px solid",borderRadius:2,overflow:"hidden",backgroundColor:"black",gap:"2px"},children:[e.jsx(m,{onClick:()=>o(!0),variant:"subtle",sx:{backgroundColor:t?"activeYellow":"white",borderRadius:0,":hover":{backgroundColor:t?"activeYellow":"white",textDecoration:t?"none":"underline"}},children:"Unread"}),e.jsx(m,{"data-testid":"NotificationListSupabase-ShowAll",onClick:()=>o(!1),variant:"subtle",sx:{backgroundColor:t?"white":"activeYellow",borderRadius:0,":hover":{backgroundColor:t?"white":"activeYellow",textDecoration:t?"underline":"none"}},children:"All"})]}),c&&e.jsx(m,{"data-testid":"NotificationListSupabase-MarkAllRead",onClick:s,disabled:a,icon:"add",variant:"outline",children:"Mark all read"})]}),e.jsx(x,{to:"/settings/notifications",children:e.jsx(m,{icon:"account",variant:"outline",sx:{alignSelf:"flex-end"},onClick:d,showIconOnly:!0,children:"Update preferences"})})]}),a&&e.jsx(C,{}),!a&&u.map(((i,n)=>e.jsx(b,{markRead:r,modalDismiss:d,notification:i},n))),0===u.length&&!a&&e.jsx(w,{sx:{backgroundColor:"background",borderRadius:2,padding:4,textAlign:"center"},children:"Wow... No unread notifications!"})]})};try{y.displayName="NotificationListSupabase",y.__docgenInfo={description:"",displayName:"NotificationListSupabase",props:{isUpdatingNotifications:{defaultValue:null,description:"",name:"isUpdatingNotifications",required:!0,type:{name:"boolean"}},markAllRead:{defaultValue:null,description:"",name:"markAllRead",required:!0,type:{name:"() => void"}},markRead:{defaultValue:null,description:"",name:"markRead",required:!0,type:{name:"(id: number) => void"}},modalDismiss:{defaultValue:null,description:"",name:"modalDismiss",required:!0,type:{name:"() => void"}},notifications:{defaultValue:null,description:"",name:"notifications",required:!0,type:{name:"Notification[]"}}}}}catch{}export{y as N};